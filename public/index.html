<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title></title>
  </head>
  <body>
    Name: <input type = 'text' id = 'name'/>
    Comment: <input type = 'text' id = 'comment'/>
    <input type = 'submit' id = 'button'>
    <div>
      <pre id = 'messages'/>
    </div>
    <script>

      /* Submit name & comment text; send to a file */
      const button = document.getElementById('button');
      button.onclick = () => {
        const name = document.getElementById('name').value;
        const comment = document.getElementById('comment').value;
        const xhttp = new XMLHttpRequest();
        xhttp.open('GET', `/submit?name=${name}&comment=${comment}`);
        xhttp.send();
      }

      /* Get chat file every second & display */
      const getChatFile = () => {
        const xhttp = new XMLHttpRequest();
        xhttp.open('GET', '/inbox.txt');
        xhttp.onreadystatechange = () => {
          if(xhttp.responseText){
            const content = document.getElementById('messages');
            content.innerHTML = xhttp.responseText;
          }
        }
        xhttp.send();
      }
      window.setInterval(getChatFile, 1000);

    </script>
  </body>
</html>
